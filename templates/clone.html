<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stimme klonen - OpenVoice</title>
    <style>
        * { box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; background: #1a1a2e; color: #eee; }
        h1 { color: #00d4ff; }
        a { color: #00d4ff; }
        .nav { margin-bottom: 20px; }
        .nav a { margin-right: 15px; }
        
        .engine-tabs { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        .engine-tab { padding: 10px 20px; border: 2px solid #333; background: #252540; border-radius: 8px; cursor: pointer; transition: all 0.2s; }
        .engine-tab:hover { border-color: #00d4ff; }
        .engine-tab.active { background: #00d4ff; color: #1a1a2e; border-color: #00d4ff; }
        .engine-tab small { display: block; font-size: 0.7em; opacity: 0.8; }
        
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; color: #aaa; }
        input[type="text"], input[type="file"] { width: 100%; padding: 10px; border: 1px solid #333; border-radius: 8px; background: #252540; color: #eee; }
        
        button { background: #00d4ff; color: #1a1a2e; border: none; padding: 15px 30px; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: bold; }
        button:hover { background: #00b8e6; }
        
        .error { background: #ff4444; color: white; padding: 15px; border-radius: 8px; margin-bottom: 15px; }
        .success { background: #44ff44; color: #1a1a2e; padding: 15px; border-radius: 8px; margin-bottom: 15px; }
        
        .voices-list { background: #252540; padding: 15px; border-radius: 8px; margin-top: 20px; }
        .voices-list h3 { margin-top: 0; color: #00d4ff; }
        .voice-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 10px; }
        .voice-item { background: #1a1a2e; padding: 8px 12px; border-radius: 5px; text-align: center; }
        
        .tip { background: #333; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #00d4ff; }
    </style>
</head>
<body>
    <div class="nav">
        <a href="/">Home</a>
        <a href="/talk">Sprechen</a>
        <a href="/voiceClone">Stimme klonen</a>
    </div>
    
    <h1>Stimme klonen</h1>
    
    <div class="tip">
        <strong>Tipp:</strong> Lade eine saubere Audio-Aufnahme (5-30 Sekunden) hoch. 
        Wenig Hintergrundgeraeusche und deutliche Sprache liefern die besten Ergebnisse.
    </div>
    
    {% if error %}
    <div class="error">{{ error }}</div>
    {% endif %}
    
    {% if success %}
    <div class="success">{{ success }}</div>
    {% endif %}
    
    <form method="POST" enctype="multipart/form-data">
        <!-- Engine Tabs -->
        <div class="engine-tabs">
            {% for key, srv in servers.items() %}
            <div class="engine-tab {% if key == 'xtts' %}active{% endif %}" 
                 data-engine="{{ key }}" onclick="selectEngine('{{ key }}')">
                <strong>{{ srv.name }}</strong>
                <small>{{ srv.desc }}</small>
            </div>
            {% endfor %}
        </div>
        <input type="hidden" name="engine" id="engineInput" value="xtts">
        
        <div class="form-group">
            <label>Name der Stimme</label>
            <input type="text" name="name" placeholder="z.B. meine_stimme" required pattern="[a-zA-Z0-9_-]+">
            <small style="color:#666">Nur Buchstaben, Zahlen, Unterstriche und Bindestriche</small>
        </div>
        
        <div class="form-group">
            <label>Audio-Datei</label>
            <input type="file" name="audio" accept="audio/*" required>
            <small style="color:#666">WAV, MP3, M4A, etc. (5-30 Sekunden empfohlen)</small>
        </div>
        
        <button type="submit">Stimme klonen</button>
    </form>
    
    <div class="voices-list">
        <h3>Vorhandene Stimmen</h3>
        {% for engine, voice_list in voices.items() %}
        {% if voice_list %}
        <h4 style="color:#888; margin-bottom:10px;">{{ servers[engine].name }}</h4>
        <div class="voice-grid" style="margin-bottom:20px;">
            {% for v in voice_list %}
            <div class="voice-item">{{ v }}</div>
            {% endfor %}
        </div>
        {% endif %}
        {% endfor %}
    </div>
    
    <script>
        function selectEngine(engine) {
            document.querySelectorAll('.engine-tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`[data-engine="${engine}"]`).classList.add('active');
            document.getElementById('engineInput').value = engine;
        }
    </script>
</body>
</html>
